{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{146:function(t,e,i){\"use strict\";i.r(e);var n=i(0);!function(){var t=new Error(\"Cannot find module 'Helpers/sentiment-composition.js'\");throw t.code=\"MODULE_NOT_FOUND\",t}(),i(1).tag2(\"sentimentcompetitionpie\",'<div class=\"widget-2 mg-t-20\" each=\"{o,i in prjArray}\"> <div class=\"card shadowbase overflow-hidden\"> <div class=\"card-header pd-20 bg-transparent bb-1\"> <h6 class=\"card-title tx-20 tx-uppercase tx-12 mg-b-0\"> <img src=\"assets/img/image/pie-chart-teal.png\" width=\"30\" height=\"30\" class=\"mg-r-5\"> COMPETITION SENTIMENT CHART(%) {prjList ? prjList[o] : \\'X\\'} </h6> </div> <div class=\"ripple-loader\" if=\"{isLoading}\"></div> <div class=\"card-body pd-20 bd-color-gray-lighter height660 textcenter mg-t-0\" if=\"{notdata}\"> No data found, please input another dates </div> <div class=\"card-body pd-10 bd-color-gray-lighter height680\" id=\"sentimencompetitionpie{o}\" if=\"{!notdata}\"> </div> </div> </div>',\"\",\"\",(function(t){this.sentimentCompetition=null,this.data={},this.totalProject={},this.totaldataSeries={},this.prjList={},this.render=()=>{APP.apiGet({path:\"projects/list\",data:{selected_fields:\"key_id,key_name\"},success:function(t){setTimeout(()=>{this.renderdata(t)},1e3);let e=Object(n.clone)(this.parent.search);const i=\"string\"==typeof e.project?e.project.split(\",\"):e.project,o=this.parent.competitionProjects?Object(n.concat)(i,this.parent.competitionProjects):i;this.allProjects=Object(n.filter)(o.map(t=>parseInt(t)),t=>!isNaN(t)),this.isCombine=e.project.split(\",\").length>1;let a=this.parent.projectList;for(let t in this.allProjects){const e=parseInt(this.allProjects[t]),i=Object(n.find)(a,{key_id:e});i&&i.key_name&&(this.prjList[e]=this.isCombine?\"All\":i.key_name)}this.update()}.bind(this)})},this.renderdata=t=>{this.update({isLoading:!0}),APP.log(\"sentiment : update data\");const i=p(\"project\"),n=document.projectCompetition?document.projectCompetition:\"\",o=decodeURIComponent(`${i},${n}`),a=\"string\"==typeof o?o.split(\",\").map(t=>t.trim()).filter(t=>\"\"!==t).toString():\"\";this.prjArray=a.split(\",\");const s=a.split(\",\");async.each(s,(t,i)=>{async.parallel({positive:function(i){e((function(t){i(null,t.items)}),\"positive\",t)},negative:function(i){e((function(t){i(null,t.items)}),\"negative\",t)},neutral:function(i){e((function(t){i(null,t.items)}),\"neutral\",t)}},(e,i)=>{this.update({isLoading:!1});const n=i.positive[0]?i.positive[0].count:0,o=i.negative[0]?i.negative[0].count:0,a=n+o+(i.neutral[0]?i.neutral[0].count:0);if(i){const e=[{y:n,name:\"positive\",color:\"#7ee87c\",percentase:(100*n/a).formatMoney(2)},{y:o,name:\"negative\",color:\"#ff007a\",percentase:(100*o/a).formatMoney(2)}];this.createChart({dataseries:e,prjid:t}),this.totaldataSeries[t]=e}}),i()})};var e=(t,e,i)=>{let o=Object(n.clone)(this.parent.search);o.section=e;APP.currentProject;o.project=i;APP.apiGet({path:\"stream/brand/shareofvoice\",data:o,success:function(e){t(e)}.bind(this)},t)};this.createChart=t=>{const e=t.dataseries||[],i=t.prjid||\"\";if(e.length<=0)return!1;Highcharts.chart(\"sentimencompetitionpie\"+i,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:\"pie\",height:600},title:{text:\"\"},tooltip:{pointFormat:\"{series.name}:{point.y} <br> persentase : {point.percentase:.1f}%\"},plotOptions:{pie:{allowPointSelect:!0,cursor:\"pointer\",dataLabels:{formatter:function(){return\"<span style='font-size:20px;'> \"+this.point.name+\"</br>\"+this.point.percentage.formatMoney(2)+\"%  (\"+this.y.formatMoney(0)+\")</span>\"},useHTML:!0}}},exporting:{enabled:!1},legend:{enabled:!1},credits:{enabled:!1},series:[{name:\"Mentions\",colorByPoint:!0,data:e}]})}}))},147:function(t,e,i){\"use strict\";i.r(e);var n=i(0);!function(){var t=new Error(\"Cannot find module 'Helpers/sentiment-composition.js'\");throw t.code=\"MODULE_NOT_FOUND\",t}(),i(1).tag2(\"sentimentcompetiton\",'<div class=\"widget-2 mg-t-20\"> <div class=\"card shadowbase overflow-hidden\"> <div class=\"card-header pd-20 bg-transparent bb-1\"> <h6 class=\"card-title tx-20 tx-uppercase tx-12 mg-b-0\"> <img src=\"assets/img/image/pie-chart-teal.png\" width=\"30\" height=\"30\" class=\"mg-r-5\"> COMPETITION SENTIMENT CHART (%) </h6> </div> <div class=\"ripple-loader\" if=\"{isLoading}\"></div> <div class=\"card-body pd-20 bd-color-gray-lighter height700 textcenter mg-t-0\" if=\"{nodata}\"> No data found, please input another dates </div> <div class=\"card-body pd-10 bd-color-gray-lighter height700\" id=\"sentimencompetition\" if=\"{!nodata}\"> </div> </div> </div>',\"\",\"\",(function(t){this.sentimentCompetition=null,this.data={},this.totalProject={},this.render=()=>{this.setTotal(),APP.apiGet({path:\"projects/list\",data:{selected_fields:\"key_id,key_name\"},success:function(t){this.dataproject=t,setTimeout(()=>{this.renderdata(t)},1e3),this.update()}.bind(this)})},this.setTotal=()=>{let t=Object(n.clone)(this.parent.search);const e=p(\"project\"),i=document.projectCompetition?document.projectCompetition:\"\",o=decodeURIComponent(`${e},${i}`),a=\"string\"==typeof o?o.split(\",\").map(t=>t.trim()).filter(t=>\"\"!==t).toString():\"\";t.group_service=\"true\",t.section=\"\";a.split(\",\");APP.apiGet({path:\"mentions\",data:t,success:t=>{var e=Object(n.map)(t,t=>({count:t}));this.totaldata=Object(n.sumBy)(e,\"count\"),this.update()}})},this.renderdata=t=>{this.update({isLoading:!0}),APP.log(\"sentiment : update data\"),async.parallel({positive:function(t){e((function(e){t(null,e.items)}),\"positive\")},negative:function(t){e((function(e){t(null,e.items)}),\"negative\")},neutral:function(t){e((function(e){t(null,e.items)}),\"neutral\")}},(e,i)=>{if(this.update({isLoading:!1}),i){const e=[APP.currentProject],o=document.projectCompetition?document.projectCompetition.split(\",\"):[],a=e.concat(o).filter(t=>t&&t.length>0).map(e=>Object(n.find)(t,t=>t.key_id===parseInt(e))),s=a.map(t=>t.key_name),r=i.neutral,c=i.positive,p=i.negative;let d={positive:{},negative:{},neutral:{}};for(let t in a)d.positive[a[t].key_name]=0,d.negative[a[t].key_name]=0,d.neutral[a[t].key_name]=0;for(let t in c){const e=c[t].brand_name;d.positive[e]+=c[t].count}for(let t in p){const e=p[t].brand_name;d.negative[e]+=p[t].count}for(let t in r){const e=r[t].brand_name;d.neutral[e]+=r[t].count}let l={},h={};for(let t in s){const e=s[t];h[e]=0;for(let t in d)l[t]||(l[t]=[]),h[e]+=parseInt(d[t][e]);for(let t in d){l[t]||(l[t]=[]);const i=parseInt(d[t][e]),n=parseInt(h[e]);l[t].push(100*i/n)}}let m=!function(){var t=new Error(\"Cannot find module 'Helpers/sentiment-composition.js'\");throw t.code=\"MODULE_NOT_FOUND\",t}()(\"sentimencompetition\",s,h);Object(n.each)(l,(t,e)=>{m.addSeries({name:e,color:\"positive\"===e?\"#0f8212\":\"negative\"===e?\"#eb3737\":\"#f3bc25\",data:t}),console.log({name:e,data:t})})}})};var e=(t,e)=>{let i=Object(n.clone)(this.parent.search);i.section=e;const o=APP.currentProject,a=document.projectCompetition?document.projectCompetition:\"\",s=decodeURIComponent(`${o},${a}`),r=\"string\"==typeof s?s.split(\",\").map(t=>t.trim()).filter(t=>\"\"!==t).toString():\"\";i.project=r;APP.apiGet({path:\"stream/brand/mention\",data:i,success:function(e){t(e)}.bind(this)},t)}}))}}]);","extractedComments":[]}