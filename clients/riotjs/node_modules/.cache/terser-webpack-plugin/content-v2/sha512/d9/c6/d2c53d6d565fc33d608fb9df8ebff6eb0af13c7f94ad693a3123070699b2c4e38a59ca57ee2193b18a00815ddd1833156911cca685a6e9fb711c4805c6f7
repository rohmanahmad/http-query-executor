{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{105:function(e,t,i){i(0).tag2(\"sociograpauthor\",'<div class=\"card bd-0\"> <div class=\"card overflow-hidden\"> <div class=\"card-header bg-transparent d-flex justify-content-between align-items-center\"> <h6 class=\"card-title tx-uppercase tx-12 mg-b-0\"> <img src=\"assets/img/image/share-teal.png\" width=\"20\" height=\"20\" class=\"mg-r-5\"> SOCIOGRAPH AUTHORS </h6> <span> <div class=\"btn-group\" role=\"group\" aria-label=\"Limit\"> <select class=\"btn btn-outline-info btn-icon cursor-pointer mg-r-20\" onchange=\"{changeLimit}\" ref=\"limitPage\"> <option value=\"100\" selected=\"{selected:pagelimitvalue == 100}\">100</option> <option value=\"500\" selected=\"{selected:pagelimitvalue == 500}\">500</option> <option value=\"1000\" selected=\"{selected:pagelimitvalue == 1000}\">1000</option> <option value=\"2000\" selected=\"{selected:pagelimitvalue == 2000}\">2000</option> <option value=\"3000\" selected=\"{selected:pagelimitvalue == 3000}\">3000</option> <option value=\"4000\" selected=\"{selected:pagelimitvalue == 4000}\">4000</option> <option value=\"5000\" selected=\"{selected:pagelimitvalue == 5000}\">5000</option> <option value=\"6000\" selected=\"{selected:pagelimitvalue == 6000}\">6000</option> <option value=\"7000\" selected=\"{selected:pagelimitvalue == 7000}\">7000</option> <option value=\"8000\" selected=\"{selected:pagelimitvalue == 8000}\">8000</option> <option value=\"9000\" selected=\"{selected:pagelimitvalue == 9000}\">9000</option> <option value=\"10000\" selected=\"{selected:pagelimitvalue == 10000}\">10000</option> <option value=\"11000\" selected=\"{selected:pagelimitvalue == 11000}\">11000</option> <option value=\"12000\" selected=\"{selected:pagelimitvalue == 12000}\">12000</option> </select> </div> <img src=\"assets/img/image/dowload-teal.png\" width=\"20\" height=\"20\" class=\"mg-r-15 cursor-pointer \" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Download\" onclick=\"{downloadcsv}\"> <img src=\"assets/img/image/full-screent.png\" width=\"20\" height=\"20\" class=\"mg-r-5 cursor-pointer \" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Full Screen\" onclick=\"{fullscreent}\"> <b class=\"cursor-default mg-l-10 fontweightinherit\" aria-hidden=\"true\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"???\">? </b> </span> </div> <div class=\"card-body pd-0 bd-color-gray-lighter height600 textcenter mg-t-20\" if=\"{total == 0}\"> No data found, please input another dates </div> <div class=\"ripple-loader\" if=\"{isLoading}\"></div> <div class=\"card-body pd-20 bd-color-gray-lighter height600 heightsvgsosiograph\" id=\"sosiographauthor\" if=\"{total != 0}\"> </div> </div> </div> <a id=\"return-to-top-sosiograph\" onclick=\"{outscreentsosiograph}\"><i class=\"fa fa-expand cursor-pointer colorwhite\"></i></a>',\"\",\"\",(function(e){this.renderer=null,this.pagelimitvalue=1e3,this.changeLimit=e=>{APP.log(\"change stream limit\"),this.pagelimitvalue=e.target.value,this.render()},this.render=()=>{let e=_.clone(this.parent.search);e.limit=this.pagelimitvalue,this.update({isLoading:!0}),APP.apiGet({path:\"mentions/sociograph/authors\",data:e,success:function(e){this.dataitems=e.items,e=e.items,this.datarender(e,!0),$('[data-toggle=\"tooltip\"]').tooltip()}.bind(this)})},this.datarender=(e,t)=>{if(_.isNull(this.renderer)||0!=this.total&&this.renderer.dispose(),this.total=e.length,0!=this.total){this.update();var i=e,a=Viva.Graph.graph(),o=Viva.Graph.View.svgGraphics(),s={},l=[],n=50;if(i.length<100)n=2;else if(i.length>100)n=10;else if(i.length>500)n=15;else if(i.length>1e3)n=20;else if(i.length>1500)n=25;else if(i.length>2e3)n=30;else if(i.length>3e3)n=50;n=0,i.forEach(e=>{let t=e.id.split(\".\");t.length>=2&&a.addNode(t[0]);for(let o=0;o<t.length;o++){var i=e.sentiment<0?\"#ff4027\":e.sentiment>0?\"#5dff27\":\"#f3973e\";0===o&&t.length>=2&&a.addLink(t[0],t[1],{retweet_id:e.retweet_id,stream_id:e.stream_id,user_id:e.user_id,sentiment:i,type:e.sentiment}),o<t.length-1&&o>0&&(s[t[o]]||(a.addNode(t[o]),s[t[o]]=!0),s[t[o+1]]||(a.addNode(t[o+1]),s[t[o+1]]=!0),a.addLink(t[o],t[o+1],{retweet_id:e.retweet_id,stream_id:e.stream_id,user_id:e.user_id,sentiment:i,type:e.sentiment}))}});var r=0;a.forEachNode(e=>{r<e.links.length&&(r=e.links.length)}),a.forEachNode(e=>{if(e.links.length<=n){let t=!1;e.links.forEach(e=>{a.getNode(e.toId).links.length>n&&(t=!0)}),t||l.push(e.id)}});var d=function(e,t){a.forEachLinkedNode(e,(function(e,i){var a=o.getLinkUI(i.id);a&&a.attr(\"stroke\",t?\"#999999\":i.data.sentiment)}))};o.node(e=>{let t=Viva.Graph.svg(\"g\");if(e.links.length>4)var i=\"#000\";else i=\"#246a9d\";let a=e.links.length/r*32;a=a<10?10:a;let o=Viva.Graph.svg(\"text\").attr(\"y\",10).attr(\"x\",-10).attr(\"stroke-width\",.5).attr(\"font-size\",a).attr(\"stroke\",i).attr(\"line-stroke\",i).text(e.id);$(t).hover((function(){d(e.id,!0)}),(function(){d(e.id,!1)}));let s=this;return $(t).click((function(){var t=[],i=[];_.each(e.links,(e,a)=>{t.push(e.data.retweet_id),i.push(e.data.stream_id)});var a=[],o=[];t.forEach((function(e){a.indexOf(e)<0&&a.push(e)})),i.forEach((function(e){o.indexOf(e)<0&&o.push(e)})),i=i?i.join(\",\"):null,a=a?a.join(\",\"):null,s.parent.detailmentions(null,null,null,e.id,null,null,\"Author\",null,i,a,!0)})),t.append(o),t}).placeNode((e,t)=>{e.attr(\"transform\",\"translate(\"+t.x+\",\"+(t.y-12)+\")\")}),o.link((function(e){return Viva.Graph.svg(\"path\").attr(\"stroke\",e.data.sentiment)})).placeLink((function(e,t,i){var a=\"M\"+t.x+\",\"+t.y+\"L\"+i.x+\",\"+i.y;e.attr(\"d\",a)})),l.forEach(e=>{a.removeNode(e)});var h=Viva.Graph.Layout.forceDirected(a,{springLength:50,springCoeff:.001,dragCoeff:.09,gravity:-1}),g=Viva.Graph.View.renderer(a,{graphics:o,container:document.getElementById(\"sosiographauthor\")});this.renderer=g;var p=$(\".heightsvgsosiograph\").height(),c=$(\".heightsvgsosiograph\").width();t&&setTimeout(()=>{$(\"#sosiographauthor svg\").css({width:c,height:p})},1),g.run(),setTimeout((function(){g.pause();var e=h.getGraphRect(),t=Math.min(e.x2-e.x1,e.y2-e.y1);!function e(t,i){t<i?(i=g.zoomOut(),setTimeout((function(){e(t,i)}),16)):(setTimeout((function(){g.zoomOut()}),16),setTimeout((function(){g.zoomOut()}),32),setTimeout((function(){g.zoomOut()}),50))}(Math.min($(\"#sosiographauthor\").width(),$(\"#sosiographauthor\").height())/t,1)}),1e4),this.update({isLoading:!1})}else this.update({isLoading:!1})},this.downloadcsv=()=>{var e=this.dataitems;e.length>0&&APP.downloadcsv(e,\"sociograph author\",!0)},this.fullscreent=()=>{$(\"#sosiographauthor svg\").css({display:\"block\",\"z-index\":\"9999\",position:\"fixed\",width:\"100%\",height:\"100%\",top:\"0\",right:\"0\",left:\"0\",bottom:\"0\",overflow:\"auto\",background:\"white\",zoom:\" 100%\"}),this.dataitems.length>0&&$(\"#return-to-top-sosiograph\").fadeIn(200)},this.outscreentsosiograph=()=>{let e=$(\".heightsvgsosiograph\").height(),t=$(\".heightsvgsosiograph\").width();this.datarender(this.dataitems,!0),$(\"#sosiograph svg\").css({width:t,height:e,display:\"\",\"z-index\":\"\",position:\"\",top:\"\",right:\"\",left:\"\",bottom:\"\",overflow:\"\",background:\"\"}),$(\"#return-to-top-sosiograph\").fadeOut(200),this.update()}}))}}]);","extractedComments":[]}