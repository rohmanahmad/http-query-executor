{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{139:function(t,e,i){\"use strict\";i.r(e);var n=i(0);i(24);i(1).tag2(\"sentimentcompetitionpie\",'<div class=\"widget-2 mg-t-20\" each=\"{o,i in prjArray}\"> <div class=\"card shadowbase overflow-hidden\"> <div class=\"card-header pd-20 bg-transparent bb-1\"> <h6 class=\"card-title tx-20 tx-uppercase tx-12 mg-b-0\"> <img src=\"assets/img/image/pie-chart-teal.png\" width=\"30\" height=\"30\" class=\"mg-r-5\"> COMPETITION SENTIMENT CHART(%) {prjList ? prjList[o] : \\'X\\'} </h6> </div> <div class=\"ripple-loader\" if=\"{isLoading}\"></div> <div class=\"card-body pd-20 bd-color-gray-lighter height660 textcenter mg-t-0\" if=\"{notdata}\"> No data found, please input another dates </div> <div class=\"card-body pd-10 bd-color-gray-lighter height680\" id=\"sentimencompetitionpie{o}\" if=\"{!notdata}\"> </div> </div> </div>',\"\",\"\",(function(t){this.sentimentCompetition=null,this.data={},this.totalProject={},this.totaldataSeries={},this.prjList={},this.render=()=>{APP.apiGet({path:\"projects/list\",data:{selected_fields:\"key_id,key_name\"},success:function(t){setTimeout(()=>{this.renderdata(t)},1e3);let e=Object(n.clone)(this.parent.search);const i=\"string\"==typeof e.project?e.project.split(\",\"):e.project,a=this.parent.competitionProjects?Object(n.concat)(i,this.parent.competitionProjects):i;this.allProjects=Object(n.filter)(a.map(t=>parseInt(t)),t=>!isNaN(t)),this.isCombine=e.project.split(\",\").length>1;let o=this.parent.projectList;for(let t in this.allProjects){const e=parseInt(this.allProjects[t]),i=Object(n.find)(o,{key_id:e});i&&i.key_name&&(this.prjList[e]=this.isCombine?\"All\":i.key_name)}this.update()}.bind(this)})},this.renderdata=t=>{this.update({isLoading:!0}),APP.log(\"sentiment : update data\");const i=p(\"project\"),n=document.projectCompetition?document.projectCompetition:\"\",a=decodeURIComponent(`${i},${n}`),o=\"string\"==typeof a?a.split(\",\").map(t=>t.trim()).filter(t=>\"\"!==t).toString():\"\";this.prjArray=o.split(\",\");const s=o.split(\",\");async.each(s,(t,i)=>{async.parallel({positive:function(i){e((function(t){i(null,t.items)}),\"positive\",t)},negative:function(i){e((function(t){i(null,t.items)}),\"negative\",t)},neutral:function(i){e((function(t){i(null,t.items)}),\"neutral\",t)}},(e,i)=>{this.update({isLoading:!1});const n=i.positive[0]?i.positive[0].count:0,a=i.negative[0]?i.negative[0].count:0,o=n+a+(i.neutral[0]?i.neutral[0].count:0);if(i){const e=[{y:n,name:\"positive\",color:\"#7ee87c\",percentase:(100*n/o).formatMoney(2)},{y:a,name:\"negative\",color:\"#ff007a\",percentase:(100*a/o).formatMoney(2)}];this.createChart({dataseries:e,prjid:t}),this.totaldataSeries[t]=e}}),i()})};var e=(t,e,i)=>{let a=Object(n.clone)(this.parent.search);a.section=e;APP.currentProject;a.project=i;APP.apiGet({path:\"stream/brand/shareofvoice\",data:a,success:function(e){t(e)}.bind(this)},t)};this.createChart=t=>{const e=t.dataseries||[],i=t.prjid||\"\";if(e.length<=0)return!1;Highcharts.chart(\"sentimencompetitionpie\"+i,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:\"pie\",height:600},title:{text:\"\"},tooltip:{pointFormat:\"{series.name}:{point.y} <br> persentase : {point.percentase:.1f}%\"},plotOptions:{pie:{allowPointSelect:!0,cursor:\"pointer\",dataLabels:{formatter:function(){return\"<span style='font-size:20px;'> \"+this.point.name+\"</br>\"+this.point.percentage.formatMoney(2)+\"%  (\"+this.y.formatMoney(0)+\")</span>\"},useHTML:!0}}},exporting:{enabled:!1},legend:{enabled:!1},credits:{enabled:!1},series:[{name:\"Mentions\",colorByPoint:!0,data:e}]})}}))},140:function(t,e,i){\"use strict\";i.r(e);var n=i(0),a=i(24),o=i.n(a);i(1).tag2(\"sentimentcompetiton\",'<div class=\"widget-2 mg-t-20\"> <div class=\"card shadowbase overflow-hidden\"> <div class=\"card-header pd-20 bg-transparent bb-1\"> <h6 class=\"card-title tx-20 tx-uppercase tx-12 mg-b-0\"> <img src=\"assets/img/image/pie-chart-teal.png\" width=\"30\" height=\"30\" class=\"mg-r-5\"> COMPETITION SENTIMENT CHART (%) </h6> </div> <div class=\"ripple-loader\" if=\"{isLoading}\"></div> <div class=\"card-body pd-20 bd-color-gray-lighter height700 textcenter mg-t-0\" if=\"{nodata}\"> No data found, please input another dates </div> <div class=\"card-body pd-10 bd-color-gray-lighter height700\" id=\"sentimencompetition\" if=\"{!nodata}\"> </div> </div> </div>',\"\",\"\",(function(t){this.sentimentCompetition=null,this.data={},this.totalProject={},this.render=()=>{this.setTotal(),APP.apiGet({path:\"projects/list\",data:{selected_fields:\"key_id,key_name\"},success:function(t){this.dataproject=t,setTimeout(()=>{this.renderdata(t)},1e3),this.update()}.bind(this)})},this.setTotal=()=>{let t=Object(n.clone)(this.parent.search);const e=p(\"project\"),i=document.projectCompetition?document.projectCompetition:\"\",a=decodeURIComponent(`${e},${i}`),o=\"string\"==typeof a?a.split(\",\").map(t=>t.trim()).filter(t=>\"\"!==t).toString():\"\";t.group_service=\"true\",t.section=\"\";o.split(\",\");APP.apiGet({path:\"mentions\",data:t,success:t=>{var e=Object(n.map)(t,t=>({count:t}));this.totaldata=Object(n.sumBy)(e,\"count\"),this.update()}})},this.renderdata=t=>{this.update({isLoading:!0}),APP.log(\"sentiment : update data\"),async.parallel({positive:function(t){e((function(e){t(null,e.items)}),\"positive\")},negative:function(t){e((function(e){t(null,e.items)}),\"negative\")},neutral:function(t){e((function(e){t(null,e.items)}),\"neutral\")}},(e,i)=>{if(this.update({isLoading:!1}),i){const e=[APP.currentProject],a=document.projectCompetition?document.projectCompetition.split(\",\"):[],s=e.concat(a).filter(t=>t&&t.length>0).map(e=>Object(n.find)(t,t=>t.key_id===parseInt(e))),r=s.map(t=>t.key_name),c=i.neutral,p=i.positive,d=i.negative;let l={positive:{},negative:{},neutral:{}};for(let t in s)l.positive[s[t].key_name]=0,l.negative[s[t].key_name]=0,l.neutral[s[t].key_name]=0;for(let t in p){const e=p[t].brand_name;l.positive[e]+=p[t].count}for(let t in d){const e=d[t].brand_name;l.negative[e]+=d[t].count}for(let t in c){const e=c[t].brand_name;l.neutral[e]+=c[t].count}let h={},m={};for(let t in r){const e=r[t];m[e]=0;for(let t in l)h[t]||(h[t]=[]),m[e]+=parseInt(l[t][e]);for(let t in l){h[t]||(h[t]=[]);const i=parseInt(l[t][e]),n=parseInt(m[e]);h[t].push(100*i/n)}}let u=o()(\"sentimencompetition\",r,m);Object(n.each)(h,(t,e)=>{u.addSeries({name:e,color:\"positive\"===e?\"#0f8212\":\"negative\"===e?\"#eb3737\":\"#f3bc25\",data:t}),console.log({name:e,data:t})})}})};var e=(t,e)=>{let i=Object(n.clone)(this.parent.search);i.section=e;const a=APP.currentProject,o=document.projectCompetition?document.projectCompetition:\"\",s=decodeURIComponent(`${a},${o}`),r=\"string\"==typeof s?s.split(\",\").map(t=>t.trim()).filter(t=>\"\"!==t).toString():\"\";i.project=r;APP.apiGet({path:\"stream/brand/mention\",data:i,success:function(e){t(e)}.bind(this)},t)}}))}}]);","extractedComments":[]}