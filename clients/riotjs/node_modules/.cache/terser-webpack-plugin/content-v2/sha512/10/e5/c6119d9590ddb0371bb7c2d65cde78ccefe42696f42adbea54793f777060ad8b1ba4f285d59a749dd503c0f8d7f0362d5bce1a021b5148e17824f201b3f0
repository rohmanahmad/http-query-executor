{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{84:function(e,t,i){\"use strict\";i.r(t);var s=i(0);i(8);i(1).tag2(\"streamsdowload\",'<div class=\"row\"> <div class=\"col-md-12\"> <div class=\"widget-2\"> <div class=\"card shadow-base\"> <div class=\"card-header borderbottom0\"> <div class=\"dropdown mg-r-10\"> <a href=\"\" class=\"tx-gray-800 d-inline-block\" data-toggle=\"dropdown\"> <div class=\"ht-45 pd-x-20 bd d-flex align-items-center justify-content-center height40\"> <i if=\"{isXlsxActive || isJsonActive || isCsvxActive}\" class=\"fa fa-spinner fa-spin mg-r-10\"></i> <span class=\"mg-r-10 tx-13 tx-medium\">Download</span> <i class=\"fa fa-angle-down mg-l-10\"></i> </div> </a> <div class=\"dropdown-menu pd-10 wd-200\"> <nav class=\"nav nav-style-1 flex-column\"> <a class=\"{isXlsxActive ? \\'nav-link disabled\\' : \\'nav-link cursor-pointer\\'}\" onclick=\"{() => exportStreams(⁗xlsx⁗)}\"> <i if=\"{!isXlsxActive}\" class=\"fa fa-download tx-22\"></i> <i if=\"{isXlsxActive}\" class=\"fa fa-spinner fa-spin tx-22\"></i> XLS</a> <a class=\"{isCsvxActive ? \\'nav-link disabled\\' : \\'nav-link cursor-pointer\\'}\" onclick=\"{() => exportStreams(⁗csv⁗)}\"> <i if=\"{!isCsvxActive}\" class=\"fa fa-download tx-22\"></i> <i if=\"{isCsvxActive}\" class=\"fa fa-spinner fa-spin tx-22\"></i> CSV </a> <a class=\"{isJsonActive ? \\'nav-link disabled\\' : \\'nav-link cursor-pointer\\'}\" onclick=\"{() => exportStreams(⁗json⁗)}\"> <i if=\"{!isJsonActive}\" class=\"fa fa-download tx-22\"></i> <i if=\"{isJsonActive}\" class=\"fa fa-spinner fa-spin tx-22\"></i> JSON</a> </nav> </div> </div> <div class=\"btn-group\" role=\"group\" aria-label=\"Limit\"> <select class=\"btn btn-outline-info btn-icon mg-r-5 pull-right mg-t-20 selectTimeline cursor-pointer\" onchange=\"{changeLimit}\" ref=\"limitPage\"> <option value=\"5\" selected=\"{selected:pagelimitvalue == 5}\">5</option> <option value=\"10\" selected=\"{selected:pagelimitvalue == 10}\">10</option> <option value=\"20\" selected=\"{selected:pagelimitvalue == 20}\">20</option> <option value=\"50\" selected=\"{selected:pagelimitvalue == 50}\">50</option> <option value=\"100\" selected=\"{selected:pagelimitvalue == 100}\">100</option> <option value=\"300\" selected=\"{selected:pagelimitvalue == 300}\">300</option> </select> <pagging pagination=\"{pagination}\" class=\"pagingrightstreams\"></pagging> </div> </div> </div> </div> </div> </div> <div class=\"row mg-t-10\" if=\"{isLoading}\"> <div class=\"col-md-12\"> <div class=\"card shadow-base bd-0 pd-25 ht-100p\" if=\"{isLoading}\"> <div class=\"media mg-b-25\"> <div class=\"ripple-loader\"></div> </div> </div> </div> </div> <div class=\"row mg-t-10\" if=\"{total == 0}\"> <div class=\"col-md-12\"> <div class=\"card shadow-base bd-0 pd-25 ht-100p\"> <div class=\" mg-b-25 textcenter mg-t-20\"> No data found, please input another dates </div> </div> </div> </div> <div class=\"row mg-t-10 {ripple-loader-sentiment-r10:isLoading}\" each=\"{items}\" id=\"setvaleu{_id}\"> <div class=\"col-md-12\"> <div class=\"card shadow-base bd-0 pd-20 ht-100p\"> <div if=\"{isLoadingset(_id)}\" class=\"ripple-loader-sentiment\"></div> <div class=\"media mg-b-25\"> <img alt=\"\" riot-src=\"{user.avatar}\" if=\"{user.avatar}\" class=\"d-flex wd-40 rounded-circle mg-r-15\" alt=\"Image\" onerror=\"this.onerror=null;this.src=\\'https://ui-avatars.com/api/?background=0D8ABC&color=fff&length=2&rounded=true&name={user.name}\\'\" name=\"{user.real_name ? user.real_name : user.name}\"> <img alt=\"\" riot-src=\"https://ui-avatars.com/api/?background=0D8ABC&color=fff&length=2&rounded=true&name={user.name}\" if=\"{!user.avatar}\" class=\"d-flex wd-40 rounded-circle mg-r-15\" alt=\"Image\" onerror=\"this.onerror=null;this.src=\\'https://ui-avatars.com/api/?background=0D8ABC&color=fff&length=2&rounded=true&name={user.name}\\';\" name=\"{user.real_name ? user.real_name : user.name}\"> <div class=\"media-body mg-t-2\"> <h6 class=\"mg-b-5 tx-14 mg-t-0\"> <a rel=\"noopener\" href=\"{source}\" target=\"_blank\" class=\"tx-inverse\">{user.real_name ? user.real_name : user.name}</a> <p class=\"tx-12 pull-right mg-r-5\"> <i class=\"icon ion-calendar\"></i> {date_format}</p> </h6> <div lass=\"tx-12\"> <span><a rel=\"noopener\" href=\"{source}\" target=\"_blank\" class=\"metricsentimentone cursor-pointer\"> <i class=\" fa fa-share-alt\" aria-hidden=\"true\"></i> {service} </a></span> </div> </div> </div> <p class=\"{tx-17:opts.corection == \\'true\\'} mg-b-25 {tx-inverse:opts.corection == \\'true\\'} {color222:opts.corection == \\'false\\'} textjustify\"> <span> <img alt=\"\" if=\"{image != ⁗⁗ && image != null}\" riot-src=\"{image}\" class=\"imagestreams cursor-pointer\" data-toggle=\"modal\" data-target=\"#buzzerimg\" onclick=\"{imgmodalf}\" onerror=\"this.onerror=null;this.src=/assets/images/components/icons/imagenotavailable.jpg\\';\" name=\"{user.real_name ? user.real_name : user.name}\"> </span> {text.length > 500 ? text.substring(0,500) + \\'...\\' : text} </p> <div class=\"media align-items-center pull-right mg-t-10\"> <div class=\"media-body mg-t-min-10\"> <div class=\"btn btn-outline-danger rounded-circle cursor-pointer pull-right btncirclesentiment40\" onclick=\"{deletes}\"><i class=\"fa fa-trash-o\"></i></div> <div id=\"neutral\" class=\"btn btn-outline-neutral rounded-circle cursor-pointer pull-right mg-r-10 {active:sentiment ? sentiment.value == 0 : null} btncirclesentiment40\" onclick=\"{setSentiment}\"><i id=\"neutral\" class=\"fa fa-question-circle\"></i></div> <div id=\"negative\" class=\"btn btn-outline-negative rounded-circle cursor-pointer pull-right mg-r-10 {active:sentiment ? sentiment.value < 0 : null} btncirclesentiment40\" onclick=\"{setSentiment}\"><i id=\"negative\" class=\"fa fa-thumbs-o-down\"></i></div> <div id=\"positive\" class=\"btn btn-outline-positive rounded-circle cursor-pointer pull-right mg-r-10 {active:sentiment ? sentiment.value > 0 : null} btncirclesentiment40\" onclick=\"{setSentiment}\"><i id=\"positive\" class=\"fa fa-thumbs-o-up\"></i></div> <div id=\"sociomile\" class=\"btn btn-outline-indigo rounded-circle cursor-pointer {active:is_connect_sociomile} pull-right mg-r-10 btncirclesentiment40\" onclick=\"{integrasi}\"><i id=\"sociomile\" class=\"cursor-pointer ivocon i-sociomile hs-grey btncirclesentimentposition sociomile mg-r-0\" style=\"margin-left:0px;\"></i></div> </div> </div> </div> </div> </div> <div class=\"modal fade\" id=\"buzzerimg\" tabindex=\"-1\"> <div class=\"modal-dialog\" role=\"document\"> <div class=\"modal-content\"> <div class=\"modal-body\"> <img alt=\"\" riot-src=\"{imgmodal}\" class=\"width450\" onerror=\"this.onerror=null;this.src=/assets/images/components/icons/imagenotavailable.jpg\\';\" name=\"{modalName}\"></img> </div> <div class=\"modal-footer\"> <div class=\"col-md-12\"> <button type=\"button\" id=\"cancel\" class=\"btn btn-outline-primary btn-block mg-b-10 mg-t-10 mg-r-10 width100 pull-right\" data-dismiss=\"modal\">Close</button> </div> </div> </div> </div> </div> <table id=\"excelDataTable\" border=\"1\"> </table>','streamsdowload .nav-link.disable,[data-is=\"streamsdowload\"] .nav-link.disable{ pointer-events: none !important; cursor: default !important; color: white !important; background: gray !important; }',\"\",(function(e){this.isLoading=!0,this.hiddenForm={},this.error=!1,this.valuedata=\"This value is required\",this.pagelimitvalue=10,this.isXlsxActive=!1,this.isCsvxActive=!1,this.isJsonActive=!1,this.userLoadingSentiment,this.xhr=null;this.dataStreams=[],this.ontotal=0,this.idtotal={},this.showForm=e=>{const t=e.item._id;this.error=!1,this.jumalahtotal=this.ontotal+1,this.ontotal=this.jumalahtotal,this.idtotal[this.jumalahtotal]=t,this.idtotal[this.jumalahtotal-1]==t?this.hiddenForm[t]?this.hiddenForm[t]=!1:this.hiddenForm[t]=!0:(this.hiddenForm[t]=!0,this.hiddenForm[this.idtotal[this.jumalahtotal-1]]=!1),setTimeout((function(){}),1),this.update()},this.updateKeyword=e=>{const t=e.item._id,i=p(\"project\")?p(\"project\"):APP.getProject(),s=this.refs.sentimentValue.value,a=this.refs.inputValue.value,r={project:i,type:s,value:a};a?APP.apiGet({path:\"stream/correction/append\",data:r,success:e=>{$.notify(\"Sentiment changed to \"+s,\"info\"),this.hiddenForm[t]=!1,this.update()}}):($(\"#kywordupdate\").focus(),swal({title:\"Alert\",text:\"This value keyword is required\",type:\"warning\",showCancelButton:!1,confirmButtonColor:\"#42a3b8\",closeOnConfirm:!0}))},this.search={project:p(\"project\")?p(\"project\"):APP.getProject()},this.data=\"\",this.query={limit:pageLimit,page:0,sort:\"-name\"},this.pagination={page:1,cb:t=>{this.update({Loading:!0,isLoading:!0}),this.query.page=(t-1)*this.query.limit,this.render(),\"true\"==e.corection?$(\"body,html\").animate({scrollTop:290},500):$(\"body,html\").animate({scrollTop:780},500)}},this.imgmodalf=e=>{this.modalName=e.item.user.name,this.imgmodal=e.item.image},this.changeLimit=e=>{APP.log(\"change stream limit\"),this.pagelimitvalue=e.target.value,this.update({isLoading:!0}),e.preventDefault(),this.query.limit=parseInt(e.target.value),this.query.page=0,this.pagination.page=1,setTimeout(function(){this.isLoading=!1,this.update()}.bind(this),2e3),this.render()},this.isLoadingset=e=>this.userLoadingSentiment===e,this.on(\"mount\",()=>{this.isLoading=!0,this.isLoad=!0,this.filter=!1,this.xhr=null,this.refs.limitPage.value=pageLimit,this.update()}),this.integrasi=e=>{e.preventDefault(),APP.log(\"integrate stream\");var t=e.item.service;let i=e.item._id;\"twitter\"==t&&(this.userLoadingSentiment=i,e.item.is_connect_sociomile=!0),this.search.streamid=i,APP.apiPost({path:\"stream/sociomile?project=\"+(+p(\"project\")?p(\"project\"):APP.getProject()),data:{streamid:i},error:(e,t,i)=>{APP.error(e),this.userLoadingSentiment=void 0,this.render(),this.update()},success:e=>{APP.log(\"success integrated to sociomile\"),$(\"#setvaleu\"+i+\" #sociomile\").addClass(\"active\"),$.notify(\"Stream moved to Sociomile \",\"info\"),this.userLoadingSentiment=void 0,this.update()}})},this.valueidcheck={},this.setSentiment=e=>{e.preventDefault(),APP.log(\"setting sentiment\");let t=e.target.id,i=e.item._id;this.search.streamid=i,this.search.sentiment=t,$(\"#setvaleu\"+i+\" #negative\").removeClass(\"active\"),$(\"#setvaleu\"+i+\" #positive\").removeClass(\"active\"),$(\"#setvaleu\"+i+\" #neutral\").removeClass(\"active\"),$(\"#setvaleu\"+i+\" #\"+t).addClass(\"active\"),APP.apiGet({path:\"stream/update_sentiment\",data:this.search,success:s=>{if($.notify(\"Sentiment changed to \"+this.search.sentiment,\"info\"),this.valueidcheck[i])var a=this.valueidcheck[i];else a=e.item.sentiment.value;0!=a&&null!=a||this.parent.refs.sentiment.remove_dataneutrla(-1),\"neutral\"==t&&this.parent.refs.sentiment.update_dataneutrla(1),1==a&&this.parent.refs.sentiment.remove_datapositive(-1),\"positive\"==t&&this.parent.refs.sentiment.update_datapositive(1),-1==a&&this.parent.refs.sentiment.remove_datanegative(-1),\"negative\"==t&&this.parent.refs.sentiment.update_datanegative(1);var r=\"positive\"===t?1:(t=\"negative\")?-1:0;this.valueidcheck[i]=r,this.userLoadingSentiment=void 0,this.update()}})},this.deletes=e=>{e.preventDefault(),APP.log(\"deleting stream\");let t=e.item._id;this.search.streamid=t,APP.apiGet({path:\"stream/delete_stream\",data:this.search,parse_data:!0,success:e=>{$(\"#setvaleu\"+t).fadeOut(1),this.parent.refs.sentiment.update_data(),this.parent.setTotal()}})},this.render=()=>{APP.log(\"render Stream timeline\");const t=Object(s.find)(this.times,{selected:!0}),i=Object(s.map)(this.parent.channels,e=>e.id);let a=this.parent.search;a.type=t,a.limit=this.query.limit,a.page=this.query.page,a.pagination=\"yes\",a.service_category=i.join(\",\");var r=\"\",n=0;for(let e in a)a[e]&&\"\"!=a[e]&&(r+=n>0?`&${e}=${encodeURIComponent(a[e])}`:`?${e}=${encodeURIComponent(a[e])}`,n++);this.xhr=APP.apiPost({path:\"stream\"+r,success:(t,i,s)=>{this.datastreams=t.item;var a=t.item;t.total;a&&(a=a.map(e=>(e.checked=!1,e))),this.items=a,this.total=this.items.length,this.pagination.pages=Math.ceil(t.total/this.query.limit),this.isLoad=!1,this.Loading=!1,this.userLoadingSentiment=void 0,$('[data-toggle=\"tooltip\"]').tooltip(),this.update({isLoading:!1}),e.corection}})},this.rendermax=e=>{let t=this.parent.search;t.pagination=\"yes\",t.limit=10;var i=\"\",s=0;for(let e in t)t[e]&&\"\"!=t[e]&&(i+=s>0?`&${e}=${encodeURIComponent(t[e])}`:`?${e}=${encodeURIComponent(t[e])}`,s++);this.xhr=APP.apiPost({path:\"stream\"+i,success:(e,t,i)=>{}})},this.doDownload=e=>{window.open(e,\"_blank\")},this.getExportStreamState=e=>\"csv\"==e?this.isCsvxActive:\"xlsx\"==e?this.isXlsxActive:\"json\"==e?this.isJsonActive:void 0,this.exportStreamsLoading=(e,t)=>{\"csv\"==e?this.isCsvxActive=t:\"xlsx\"==e?this.isXlsxActive=t:\"json\"==e&&(this.isJsonActive=t)},this.formatLabels=(e,t)=>{let i=[];if(!e||0==e.length)return i;switch(t){case\"since\":i.push({value:moment(e).format(\"YYYY-MM-DD\"),key:t}),i.push({value:moment(e).format(\"HH:mm\"),key:\"since_time\"});break;case\"until\":i.push({value:moment(e).format(\"YYYY-MM-DD\"),key:t}),i.push({value:moment(e).format(\"HH:mm\"),key:\"until_time\"});break;case\"project\":e.forEach(e=>{i.push({key:\"project\",value:String(e)})});break;case\"service_category\":e.forEach(e=>{i.push({key:t,value:e})});break;case\"query\":i.push({key:t,value:e});break;case\"domain\":case\"author\":e.forEach(e=>{i.push({key:t,value:e})});break;case\"type\":i.push({key:t,value:e})}return i},this.exportStreams=(e=\"csv\")=>{let t=this;if(this.getExportStreamState(e))return;this.exportStreamsLoading(e,!0),this.update();let i={...this.parent.search},s=_.result(localStorage,\"filter_timesince\",\"00:00\"),a=_.result(localStorage,\"filter_timeuntil\",\"59:59\"),r=_.result(i,\"since\",moment().startOf(\"day\").format(\"YYYY-MM-DD\")),n=_.result(i,\"until\",moment().endOf(\"day\").format(\"YYYY-MM-DD\"));if(i.since=moment(`${r} ${s}`),i.until=moment(`${n} ${a}`),\"\"==s&&(i.since=i.since.startOf(\"day\")),\"\"==a&&(i.until=i.until.endOf(\"day\")),!i.since.isValid())return $.notify(\"since invalid date format\",\"error\"),this.exportStreamsLoading(e,!1),void this.update();if(!i.until.isValid())return $.notify(\"until invalid date format\",\"error\"),this.exportStreamsLoading(e,!1),void this.update();i.project=_.result(i,\"project\",\"\").trim().toLowerCase().split(\",\").filter(e=>e).map(e=>Number(e)),i.service_category=_.result(i,\"service_category\",\"\").trim().toLowerCase().split(\",\").filter(e=>e),i.query=_.result(i,\"q\",\"\"),i.domain=_.result(i,\"domain\",\"\").trim().toLowerCase().split(\",\").filter(e=>e),i.author=_.result(i,\"author\",\"\").trim().toLowerCase().split(\",\").filter(e=>e),i.tag=_.result(i,\"taging\",\"\").trim().toLowerCase().split(\",\").filter(e=>e);let o=[\"since\",\"until\",\"project\",\"service_category\",\"query\",\"domain\",\"author\",\"tag\",\"type\"],l=[];i.type=e,o.forEach(e=>{o.includes(e)&&(l=[...l,...this.formatLabels(i[e],e)])}),delete i.q,l=[...l,{key:\"user_id\",value:localStorage.userid}],APP.apiPost({path:\"task/create\",contentType:\"application/json; charset=utf-8\",data:JSON.stringify({name:`export_stream_raw_${i.since.format(\"YYYY-MM-DD HH:mm\")}_${i.until.format(\"YYYY-MM-DD HH:mm\")}_${i.project.join(\"-\")}`,namespace:\"default\",type:\"export_stream\",description:\"simple task\",chedulerType:0,labels:l,payload:JSON.stringify(i)}),success:function(i){$.notify(\"Download Streams has been scheduled\",\"info\"),APP.apiPut({path:\"task/start\",data:{id:i.result.id,type:\"export_stream\"},success:function(){t.exportStreamsLoading(e,!1),$.notify(`starting task export_stream ${i.result.id} sucess`,\"info\"),t.update()},error:function(){t.exportStreamsLoading(e,!1),$.notify(\"starting task failed, please check the background task menu\",\"error\"),t.update()}})},error:function(){t.exportStreamsLoading(e,!1),$.notify(\"Download Streams failed to scheduled\",\"error\"),this.update()}})},this.downloadJson=()=>{var e=this.datastreams;e=Object(s.map)(e,(function(e,t){var i=e.sentiment.value;return{service:e.service,date:moment(e.date).format(\"YYYY/MM/DD\"),time:moment(e.date_format).format(\"h:mm:ss \"),message:e.text,user:e.user.name,follower:e.user.followers?e.user.followers:0,sentiment:0==i?\"neutral\":i>0?\"positive\":\"negative\",url:e.source}}));var t=JSON.stringify(e);this.downloadrenderjson(t,\"streams\",\"json\")},this.downloadrenderjson=(e,t,i)=>{var s=document.createElement(\"a\"),a=new Blob([e],{type:i});s.href=URL.createObjectURL(a),s.download=t+\".json\",s.click()},this.reload=()=>{this.Loading=!0,this.render()},this.on(\"unmount\",()=>{this.xhr&&this.xhr.abort(),delete this.xhr})}))}}]);","extractedComments":[]}