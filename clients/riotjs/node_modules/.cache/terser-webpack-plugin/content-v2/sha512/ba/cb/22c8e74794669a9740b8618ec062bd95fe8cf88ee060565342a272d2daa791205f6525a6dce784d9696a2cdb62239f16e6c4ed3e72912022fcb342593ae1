{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{161:function(t,e,i){\"use strict\";i.r(e);var r=i(29),a=i.n(r);i(0).tag2(\"chartcompetition\",'<div class=\"row\"> <div class=\"col-md-12 col-12 mb-4 text-center\"> <b class=\"a141 f24\">STREAM COMPETITION</b> <br> <span class=\"f14 a141\">Competition by brand</span> </div> <div class=\"col-md-12\"> <div class=\"row\"> <div class=\"ripple-loader\" if=\"{isLoading}\"></div> <div class=\"col-md-12 col-12\"> <b class=\"f7c f18\">HOURLY</b> </div> <div class=\"col-md-12 col-12 p-20\"> <div id=\"chartstream_multiproject\" class=\"height-chart-infographic\"></div> </div> </div> </div> </div>',\"\",\"\",(function(t){this.nuull=!0,this.notdata=!1,this.type=\"daily\",this.chartspline=null,this.isExist=!0,this.isLoading=!0,this.chart=null,this.xhr=null,this.times=[{id:\"hourly\",name:\"Hourly\",selected:!1},{id:\"daily\",name:\"Daily\",selected:!0},{id:\"monthly\",name:\"Monthly\",selected:!1}],this.selectTime=t=>{APP.log(\"chart-positive: selectTime\"),t.preventDefault(),t.item.selected=!0;const e=t.item.id;this.times=_.map(this.times,t=>(t.id!=e&&(t.selected=!1),t)),this.update(),this.render()},this.dataProjects=[],this.render=t=>{setTimeout(()=>{this.notdata=!1,APP.log(\"chart-positive: render\"),this.nuull=!0;var e=JSON.parse(localStorage.getItem(\"projects\"))?JSON.parse(localStorage.getItem(\"projects\")):this.parent.listproject;e=_.filter(e,t=>t);const i=this.parent.projectAll.split(\",\").map(Number);_.map(e,(function(t){return{id:t.key_id,date:moment(t.key_start_date).format(\"DD MMMM YYYY\"),name:t.key_name,color:t.key_color}})).forEach(t=>{i.indexOf(t.id)>-1?t.checked=!0:t.checked=!1,this.dataProjects.push(t)});var r=_.filter(this.dataProjects,(function(t){return t.checked}));const s=_.find(this.times,{selected:!0}).id;let n=_.clone(this.parent.search);n.project=this.parent.projectAll,n.type=s;var o=r.map((function(t){return{name:t.name,color:t.color}})),l=_.reduce(o,(function(t,e){return t[e.name]=e.color,t}),{});this.update({isLoading:!0});const c=this.chartspline=a()(\"chartstream_multiproject\",s);this.xhr=APP.apiGet({path:\"stream/brand/mention\",data:n,success:e=>{let i=this.parent.component;i.chartcompetitor=!0,6===_.filter(i,t=>t).length&&this.parent.updateid(),0===(e=e.items).length?this.notdata=!0:this.update({notdata:!1});var r=_.groupBy(e,(function(t){return t.brand_name}));r=Object.keys(r).sort().reduce((t,e)=>(t[e]=r[e],t),{});var a=[];let s=1;for(let t in r){var n=_.sortBy(r[t],t=>moment(t.date).toDate());if(n=n.map((function(t){return[moment(t.date).utc().valueOf(),t.count,t.brand_name]})),!this.isExist)return;a.push({id:\"response\",shadow:!1,name:t,type:\"spline\",totalval:_.sumBy(n,1),fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,l[t]],[1,Highcharts.Color(l[t]).setOpacity(0).get(\"rgba\")]]},lineWidth:1,color:l[t],marker:{radius:3},dataLabels:{enabled:!0,color:l[t],overflow:\"justify\",allowOverlap:!0,backgroundColor:\"rgba(252, 255, 197, 0.7)\",borderWidth:1,borderRadius:5,borderColor:l[t],padding:5,align:s%2==0?\"left\":\"right\"},data:n}),s++}a=_.orderBy(a,[\"totalval\"],[\"desc\"]);for(var o=0;o<=a.length-1;o++)c.addSeries(a[o]);this.update({isLoading:!1}),_.isFunction(t)&&t()}})},2e3)},this.on(\"mount\",()=>{this.xhr=null}),this.on(\"unmount\",()=>{this.isExist=!1,this.xhr,this.chart&&this.chart.destroy(),this.chartspline&&this.chartspline.destroy()})}))},29:function(t,e,i){\"use strict\";t.exports=function(t,e){var i=36e5,r=\"MMMM DD, YYYY HH:00\";return\"daily\"==e?(i=864e5,r=\"MMMM DD, YYYY\"):\"monthly\"==e&&(i=2592e6,r=\"MMMM YYYY\"),Highcharts.setOptions({global:{useUTC:!1}}),new Highcharts.Chart({chart:{backgroundColor:\"none\",renderTo:t,type:\"spline\",marginTop:50},title:{text:\"\"},xAxis:{type:\"datetime\",gridLineWidth:1,gridLineColor:\"#f2f2f2\",minTickInterval:i,title:{text:null},labels:{style:{color:\"#ccc\"}}},yAxis:{title:{text:null},min:0,gridLineWidth:1,gridLineColor:\"#f2f2f2\",labels:{style:{color:\"#ccc\"},formatter:function(){return this.value.formatMoney(0)}}},exporting:{enabled:!1},tooltip:{formatter:function(){return[moment(this.x).format(r),\"<br>\",this.y+\" \"+this.series.name].join(\"\")}},plotOptions:{spline:{dataLabels:{enabled:!0}}},legend:{enabled:!0},credits:{enabled:!1},navigation:{buttonOptions:{enabled:!1}}})}}}]);","extractedComments":[]}